# ================================================
# 프로덕션 환경 설정 (application-prod.yaml)
# 사용 방법: --spring.profiles.active=prod
# ================================================

# 서버 설정 - HTTP (Nginx가 HTTPS 처리)
server:
  port: 9080  # 내부 포트 (Nginx를 통해서만 접근)

# 로깅 설정 - 프로덕션 환경에서는 중요한 로그만 출력
logging:
  level:
    root: WARN
    com.example.myauth: INFO
    # Spring Security 필터 체인 로깅 비활성화 (성능 향상)
    org.springframework.security: WARN

  # 로그 파일 설정
  file:
    name: /app/logs/myauth.log
    max-size: 20MB
    max-history: 30
    total-size-cap: 1GB

# JPA 설정 - 프로덕션 환경
spring:
  jpa:
    # SQL 로그 비활성화 (성능 향상)
    show-sql: false

    # Hibernate DDL 자동 생성 전략
    hibernate:
      # ddl-auto 옵션:
      # - none: 아무것도 하지 않음 (권장 - 프로덕션)
      # - validate: 엔티티와 테이블 매핑 검증만 (스키마 불일치 시 에러)
      # - update: 테이블이 없으면 생성, 있으면 컬럼 추가 (삭제는 안함)
      # - create: 시작 시 테이블 삭제 후 재생성 (데이터 손실 위험!)
      # - create-drop: 종료 시 테이블 삭제 (테스트용)
      ddl-auto: update  # 최초 배포 시 테이블 자동 생성, 이후 스키마 변경 시 자동 업데이트

    properties:
      hibernate:
        format_sql: false
        # 성능 최적화
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true

# 애플리케이션 커스텀 설정
app:
  # 쿠키 보안 설정
  cookie:
    secure: false  # HTTP 환경 (HTTPS 도메인 없음)

  # CORS 허용 출처 (프로덕션 IP)
  cors:
    allowed-origins:
      - http://15.165.81.224          # 프로덕션 프론트엔드 (포트 80)
    allowed-methods:
      - GET
      - POST
      - PUT
      - DELETE
      - OPTIONS
    allow-credentials: true  # 쿠키 전송 허용

  # OAuth 리다이렉트 설정
  oauth:
    kakao-redirect-url: http://15.165.81.224/oauth/callback  # 카카오 로그인 성공 후 프론트엔드로 리다이렉트 (포트 80)


# 프로덕션 환경 실행 (Docker 내부에서 자동 설정)
# SPRING_PROFILES_ACTIVE=prod 환경 변수로 활성화
